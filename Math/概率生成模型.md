## 概率生成模型

首先区分一下什么是概率生成模型和概率判别模型

- 概率生成模型是对于$p(x,y)$进行建模，然后利用贝叶斯计算公式计算出$p(y|x)$
- 概率判别模型是直接对于$p(y|x)$进行建模

概率生成模型中生成的意义在于对于$p(x,y)$建模之后，就可以通过抽样来生成数据$(x,y)$。

判别模型不对观测变量的分布建模，因此该模型不能够表达观测变量与目标变量之间更复杂的关系，因此生成模型更适用于无监督的任务，如分类和聚类。

明确了概率生成模型概率的概念之后，考虑逻辑回归的问题：

对于一个二分类问题，假设输入$x\in R^{n}$，对应的输出$y\in \{0,1\}$，确定一个模型，该模型接受一个输入$x$，输出该输出的对应的类别。

从生成模型角度考虑，对于$p(x,y)$进行建模，然后利用贝叶斯公式$p(y|x)=\frac{p(x,y)}{p(x)}$，例如计算$y=1$的概率：

$p(y=1|x)=\frac{p(x,y=1)}{p(x)}=\frac{p(x|y=1)p(y=1)}{p(x|y=1)p(y=1)+p(x|y=0)p(y=0)}=\frac{1}{1+\frac{p(x|y=0)p(x=0)}{p(x|y=1)p(y=1)}}$

设$z=ln\frac{p(x|y=1)p(x=1)}{p(x|y=0)p(y=0)}$，从而$p(y=1|x)=\frac{1}{1+exp(-z)}=\sigma(z)$

所以计算出$z$，则可以计算出$p(y=1|x)$

$z=ln\frac{p(x|y=1)p(x=1)}{p(x|y=0)p(y=0)}=ln\frac{p(x|y=1)}{p(x|y=0)}+ln\frac{p(y=1)}{p(y=0)}$，其中$p(y=0),p(y=1)$是可以从样本中可以得出的，剩下的则只需要计算出$ln\frac{p(x|y=1)}{p(x|y=0)}$，这里会进行一个假设，假设样本是由多维高斯分布抽样得到的，由此假设得到模型叫做**高斯判别模型**则其对应的概率密度函数为：$p(x|y)=\frac{1}{(2\pi)^{n/2}}\frac{1}{|\Sigma|^{1/2}}exp({-\frac{1}{2}(x-\mu)^{T}(\Sigma)^{-1}(x-\mu)})$

带入$z$计算公式可得：

$z=(\mu^{1}-\mu^{2})^T\Sigma^{-1}x-\frac{1}{2}(\mu^{1})\Sigma^{-1}\mu^{1}+\frac{1}{2}(\mu^{2})^{T}\Sigma^{-1}\mu^2+ln\frac{N_1}{N_2}$

可以看出$z$同$x$是一种线性关系，之后仅仅需要通过极大似然估计估计出高斯分布中的参数，最终就可求得模型。

也可以假设样本是由柏松分布得到，只不过得到的$z$中的系数$w，b$不同而已。

当然也可以通过其他假设得到$p(x|y)$，比如**朴素贝叶斯模型**，就假设了$x\in{R}^{n}$中的$n$维特性是独立的，因此：$p(x|y)=\prod_{i=1}^{n}p(x_i|y)$，然后对于单个维度$P(x_i|y)$的条件概率以及$p(y)$做出进一步的假设：

- $x_i$为连续变量：$p(x_i|y) = N(\mu_i, \sigma^2_{i})$
- $x_i$为离散变量：类别分布：$p(x_i=i|y)=\theta_i$，$\sum_{i=1}^{K}\theta_i=1$
- $p(y)=\phi^y(1-\phi)^y$

对于假设中的参数中的估计可以通过MLE的方法直接在数据集上估计即可。





